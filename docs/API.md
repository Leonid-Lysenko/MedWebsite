# API документация системы "Медицинский диагностический помощник"

## Обзор внешних API

Система интегрируется с внешними сервисами через JavaScript API для картографии и навигации.

## Картографические API

### Leaflet JS API
**Назначение:** Отображение интерактивной карты медицинских учреждений

**Версия:** 1.9.4

**Использование:**
```javascript
// Инициализация карты
const map = L.map('medicalMap').setView([55.7558, 37.6173], 13);

// Добавление слоя карты
L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}', {
    attribution: ''
}).addTo(map);
```

### OpenStreetMap Overpass API

**Назначение:** Поиск медицинских учреждений в радиусе 5 км от пользователя

**Пример запроса:**
```javascript
// Поиск больниц, поликлиник и врачей
node["amenity"="hospital"](around:5000,55.7558,37.6173);
node["amenity"="clinic"](around:5000,55.7558,37.6173);
node["amenity"="doctors"](around:5000,55.7558,37.6173);
```

### Навигационные сервисы

**Google Maps** - используется для мобильных устройств (iOS/Android)

**Яндекс.Карты** - используется для десктопных браузеров

**Логика выбора:**
```javascript
// Определение типа устройства
if (navigator.userAgent.match(/iPhone|iPad|iPod|Android/i)) {
    // Мобильные устройства - Google Maps
    window.open(`https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}`);
} else {
    // Десктопные браузеры - Яндекс.Карты  
    window.open(`https://yandex.ru/maps/?rtext=~${lat},${lng}`);
}
```

## Функции картографического компонента

### Основные функции

**`initMap()`** - инициализирует карту и определяет местоположение пользователя

**`findRealMedicalFacilities(map, lat, lng)`** - ищет медицинские учреждения вокруг указанных координат

**`openNavigation(lat, lng)`** - открывает маршрут в навигационном приложении

**`openMedicalSearch()`** - открывает ручной поиск в Яндекс.Картах

### Логика работы

   - Определение местоположения через браузерную геолокацию
   - Поиск учреждений в радиусе 5 км через OpenStreetMap
   - Отображение на карте с цветовыми индикаторами типов учреждений
   - Навигация через подходящий сервис (Google/Яндекс)

### Типы медицинских учреждений

**Система отображает на карте:**

   - Больницы (красные маркеры)
   - Поликлиники (зеленые маркеры)
   - Кабинеты врачей (синие маркеры)
   - Стоматологии (фиолетовые маркеры)

## Обработка ошибок

   - При недоступности геолокации используется Москва по умолчанию
   - При отсутствии учреждений или ошибках API предлагается ручной поиск в Яндекс.Картах