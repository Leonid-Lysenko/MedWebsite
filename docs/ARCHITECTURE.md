# Архитектура системы "Медицинский диагностический помощник"

## Обзор архитектуры

Система представляет собой трехзвенную веб-архитектуру, состоящую из клиентской части, серверной логики и компонента машинного обучения. Архитектура спроектирована с учетом принципов модульности, масштабируемости и поддерживаемости.

## Компонентная архитектура

### 1. Клиентский слой

**Технологии:** HTML, CSS, JavaScript, Bootstrap 5, Font Awesome

**Основные компоненты:**

- **Главная страница** (`home.html`)
  - Интерфейс выбора симптомов
  - Поиск и фильтрация симптомов
  - Пагинация списка симптомов
  - Валидация пользовательского ввода

- **Страница результатов** (`results.html`)
  - Визуализация вероятностей заболеваний
  - Карточки заболеваний с индикаторами серьезности
  - Навигация к детальной информации

- **База знаний** (`knowledge_base.html`)
  - Алфавитная навигация по заболеваниям
  - Поиск по названиям заболеваний
  - Фильтрация по категориям и серьезности

- **Детальная информация о заболевании** (`disease_detail.html`)
  - Полное описание заболевания
  - Рекомендации по лечению
  - Карта медицинских учреждений
  - Контакты экстренных служб

### 2. Серверный слой

**Технологии:** Django, Python 3.12.10

**Модули приложения:**

#### 2.1. Модуль представлений (`views.py`)

**Основные функции:**

- **`home()`** - обработка главной страницы
  - Загрузка списка симптомов из файла
  - Проверка статуса ML-модели
  - Формирование контекста для шаблона

- **`predict()`** - обработка диагностических запросов
  - Валидация входных симптомов
  - Векторизация симптомов для ML-модели
  - Получение предсказаний от модели
  - Форматирование результатов

- **`disease_detail()`** - отображение информации о заболевании
  - Извлечение данных из базы знаний
  - Определение источника перехода (навигационный контекст)
  - Обработка неизвестных заболеваний

- **`knowledge_base()`** - управление базой знаний
  - Группировка заболеваний по алфавиту
  - Подготовка данных для поиска и фильтрации
  - Интеграция с картографическим сервисом

#### 2.2. Модуль данных заболеваний (`disease_data.py`)

**Структура данных:**

```python
DISEASE_DATABASE = {
    "название_заболевания": {
        "description": "Медицинское описание",
        "treatment": "Рекомендации по лечению", 
        "symptoms": ["список", "симптомов"],
        "severity": "уровень_серьезности",
        "specialist": "профильный_специалист",
        "category": "категория_заболевания"
    }
}
```

**Функции:**

**`get_disease_info(disease_name)`** - единая точка доступа к данным заболеваний

   - Поиск в словаре DISEASE_DATABASE
   - Обработка неизвестных заболеваний
   - Возврат структурированных данных


#### 2.3. Модуль маршрутизации (`urls.py`)

**`""`** → home - главная страница

**`"predict/"`** → predict - обработка диагностики

**`"disease/<str:disease_name>/"`** → disease_detail - детали заболевания

**`"knowledge-base/disease/<str:disease_name>/"`** → disease_detail - детали из базы знаний

**`"about/"`** → about - информация о проекте

**`"how-to-use/"`** → how_to_use - инструкция по использованию

**`"knowledge-base/"`** → knowledge_base - база знаний

### 2. Слой машинного обучения

**Технологии:** Scikit-learn, Joblib, NumPy, Pandas

**Компоненты:**

#### 3.1. ML-модель (`lr_model_full_data.joblib`)

**Алгоритм:** Logistic Regression

**Точность:** 86% (кросс-валидация)

**Классы:** 429 заболеваний

**Признаки:** 304 симптома

**Обучение:** 240,000+ медицинских случаев

#### 3.2. Процесс предсказания

Векторизация симптомов: преобразование выбранных симптомов в бинарный вектор

Предсказание вероятностей: вызов **`model.predict_proba()`**

Ранжирование результатов: выбор топ-5 заболеваний по вероятности

Форматирование: преобразование в пользовательский формат

## Потоки данных

### 1. Поток диагностики

Пользователь → Выбор симптомов → POST /predict/ → Валидация данных →
→ Векторизация симптомов → ML-модель → Предсказание вероятностей →
→ Форматирование результатов → Отображение страницы результатов

### 2. Поток работы с базой знаний

Пользователь → GET /knowledge-base/ → Загрузка списка заболеваний →
→ Алфавитная группировка → Отображение интерфейса → Выбор заболевания →
→ GET /knowledge-base/disease/название/ → Извлечение данных →
→ Отображение детальной информации

### 3. Поток обработки ошибок

Некорректные данные → Валидация → Обнаружение ошибки →
→ Формирование сообщения об ошибке → Отображение страницы ошибки →
→ Предложение корректирующих действий